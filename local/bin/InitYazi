#!/usr/bin/env bash
set -euo pipefail

STATUS_FILE="$HOME/.config/dots/.yazi_id"
yazi_id="$RANDOM"
echo "$yazi_id" >"$STATUS_FILE"

tmux set-option status off

_emit() { sleep 0.5 && ya emit-to "$yazi_id" "$@"; }

case "${1:---default}" in
--default) _emit cd "$HOME" & ;;
--project) _emit plugin projects "load $2" & ;;
--last) _emit plugin projects load_last & ;;
*) exit 1 ;;
esac

zsh -ic "yazi --client-id $yazi_id --remote-events=tmux"

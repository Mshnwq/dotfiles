#!/usr/bin/env bash
set -euo pipefail

STATUS_FILE="$HOME/.config/dots/.yazi_id"
yazi_id="$RANDOM"
echo "$yazi_id" >"$STATUS_FILE"

tmux set-option status off

_emit() (
  sleep 1 && YAZI_ID="$yazi_id" ya emit plugin projects "$1"
)

case "${1:---default}" in
--project) _emit "load $2" & ;;
--last) _emit "load_last" & ;;
--default) _emit "load tmux" & ;;
*) exit 1 ;;
esac

zsh -ic "yazi --client-id $yazi_id"
